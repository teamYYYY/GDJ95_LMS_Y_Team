<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.lms.mapper.prof.ProfAssignmentMapper">

    <!-- 강의별 과제 리스트 -->
    <select id="selectAssignmentListByProf" resultType="com.example.lms.dto.AssignmentDTO">
        select 
            assignment_no assignmentNo,
            course_no courseNo,
            assignment_title assignmentTitle,
            assignment_status assignmentStatus,
            createdate
        from tb_assignment 
        where course_no = #{courseNo}
        order by assignment_no desc
        limit #{startRow}, #{rowPerPage}
    </select>
    
    <select id="selectAssignmentCount" resultType="int">
        select count(*) from tb_assignment where course_no = #{courseNo}
    </select>
    
    <!-- 상세보기 -->
    <select id="selectAssignmentDetail" resultType="com.example.lms.dto.AssignmentDTO">
        select 
            assignment_no assignmentNo,
            course_no courseNo,
            assignment_title assignmentTitle,
            assignment_description assignmentDescription,
            assignment_due_date assignmentDueDate,
            assignment_status assignmentStatus,
            createdate,
            updatedate
        from tb_assignment
        where assignment_no = #{assignmentNo}
    </select>
    
    <!-- 등록 -->
    <insert id="insertAssignment" parameterType="com.example.lms.dto.AssignmentDTO"
            useGeneratedKeys="true" keyColumn="assignment_no" keyProperty="assignmentNo">
        insert into tb_assignment (
            course_no,
            assignment_title,
            assignment_description,
            assignment_due_date,
            assignment_status,
            createdate
        ) values (
            #{courseNo},
            #{assignmentTitle},
            #{assignmentDescription},
            #{assignmentDueDate},
            #{assignmentStatus},
            NOW()
        )
    </insert>
    
    <!-- 수정 -->
    <update id="updateAssignment" parameterType="com.example.lms.dto.AssignmentDTO">
        update tb_assignment
        set
            assignment_title = #{assignmentTitle},
            assignment_description = #{assignmentDescription},
            assignment_due_date = #{assignmentDueDate},
            assignment_status = #{assignmentStatus},
            updatedate = NOW()
        where assignment_no = #{assignmentNo}
    </update>
    
    <!-- 삭제 -->
    <delete id="deleteAssignment">
        delete from tb_assignment
        where assignment_no = #{assignmentNo}
    </delete>

</mapper>
